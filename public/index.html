<html>

<head>
	<title>7170 Assignment1</title>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css">
</head>

<body onload="checkCookie()">

	<section class="section">
		<div class="container">
			<label class="label">You can find input someting into the search textbox.</label>
			<form action="" method="GET">
				<input type="text" name="q">
				<input type="submit" value="Search">
			</form>

			<div id="results"></div>
			<br>
			<br>

			<label class="label">Please validate the CTF here.</label>
			<label class="label">You need to find a special cookie and input its value as follow:</label>
			<div class="control">
				<input id="value">
			</div>
			<button onclick="myFunction()">Validate</button>
			<div id="results2"></div>
			<br>
			<br>
			<br>
			<br>



			<label class="label">You can find some hint here if you have no idea.</label>
			<button onclick="hint()">Hint</button>
			<br>
			<br>


			<label class="label">Maybe you will use encode tool:</label>
			<input type="text" name="a" id="nn">
			<button onclick="encode()">encode</button>
			<br>
			<br>


		</div>
	</section>

</body>

<script src="secret.js" type="text/javascript"></script>
<script>
	

	document.addEventListener('DOMContentLoaded', function () {
		var q = getQueryParameter('q');
		if (q) {

			search(q, function (error, results) {
				showQueryAndResults(q, results);
			});
		}
	});

	function search(q, callback) {
		var results = [
			'You can use XSS to find the cookies'
		];
		callback(null, results);
	}

	function showQueryAndResults(q, results) {
		var resultsEl = document.querySelector('#results');
		var html = '';

		html += '<p>Your search query:</p>';
		html += '<pre>' + q + '</pre>';
		html += '<ul>';

		for (var index = 0; index < results.length; index++) {
			html += '<li>' + results[index] + '</li>';
		}
		html += '</ul>';
		resultsEl.innerHTML = html;
	}

	function getQueryParameter(name) {
		var pairs = window.location.search.substring(1).split('&');
		var pair;
		for (var index = 0; index < pairs.length; index++) {
			pair = pairs[index].split('=');

			if (decodeURIComponent(pair[0]) === name) {
				a = decodeURIComponent(pair[1])
				return a;

			}
		}
		return false;
	}

	function hint() {
		alert("You can try to encode the your command and input it on the URL (localhost:5000/?q= + encoded command)")
	}

	function encode() {
		var a = document.getElementById("nn").value;
		var b = encodeURIComponent(a)
		alert(b);

	}

	setCookie(cname, cvalue, exdays);

	getCookie(cname);

	checkCookie();

	myFunction();

</script>

</html>